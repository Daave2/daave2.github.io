<!DOCTYPE html>
<html lang="en">
<head>
  <!-- PWA & meta -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <!-- Theme color set to pink -->
  <meta name="theme-color" content="#D13887" />
  <title>Market Street - Cleveleys Morrisons Dashboard</title>
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png" />
  <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="description" content="Market Street & Cafe operations dashboard for Cleveleys Morrisons." />

  <!-- Fonts & icons -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Styles – mobile-first (Adapted for Pink theme) -->
  <style>
  /* ---------- Variables (Base) ---------- */
  :root{
    /* Default Green Theme (will be overridden by .pink-theme) */
    --primary-color: #006400;
    --primary-color-dark: #004d00;
    --secondary-color: #FFD700;
    --bg-faint: #e6ffe6;
    --bg-card: #fff;
    --text-color: #333;
    --footer-bg: var(--primary-color);
    --footer-text: #fff;
    --shadow:0 2px 6px rgba(0,0,0,.08);
    /* Dark Mode Base */
    --bg-dark:#121212;
    --card-dark:#1e1e1e;
    --text-dark:#e0e0e0;
    --footer-dark: #333;
  }

  /* ---------- Pink Theme Override ---------- */
   body.pink-theme {
       --primary-color: #D13887; /* Deeper Pink */
       --primary-color-dark: #a12a6a; /* Darker Pink */
       --secondary-color: #FFB6C1; /* Light Pink */
       --bg-faint: #FFF0F5; /* Lavender Blush */
       --bg-card: #FFFFFF; /* White card */
       --text-color: #701c4b; /* Dark Pink/Magenta */
       --footer-bg: var(--primary-color);
       --footer-text: #fff; /* White text on pink footer */

       /* Dark Mode Overrides for Pink Theme */
        &.dark-mode {
            --primary-color: #FF69B4; /* Hot Pink */
            --primary-color-dark: #D13887; /* Deeper Pink */
            --secondary-color: #DB7093; /* Pale Violet Red */
            --bg-faint: var(--bg-dark);
            --card-dark: #4a1933; /* Dark pink-tinted */
            --text-dark: #ffebf5; /* Light pink text */
            --footer-dark: #8B008B; /* Magenta footer */
            --footer-text: #ffebf5; /* Light pink footer text */
            /* Override specific dark variables */
            --bg-card: var(--card-dark);
            --text-color: var(--text-dark);
            --footer-bg: var(--footer-dark);
        }
   }

  /* ---------- Reset / base ---------- */
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  html{scroll-behavior:smooth;font-size:100%}
  body{font-family:Roboto,system-ui,sans-serif;background:var(--bg-faint);color:var(--text-color);line-height:1.55;min-block-size:100dvh;transition:background .3s,color .3s}
  body.dark-mode{background:var(--bg-dark);color:var(--text-dark)}
  a{color:var(--primary-color);text-decoration:underline;}
  a:hover{text-decoration:none;}
  body.dark-mode a{color:var(--secondary-color);}
  img{max-inline-size:100%;block-size:auto}
  /* Focus visible */
  a:focus-visible, button:focus-visible, select:focus-visible, input:focus-visible, [tabindex="0"]:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 2px; border-radius: 2px; }
  body.dark-mode a:focus-visible, body.dark-mode button:focus-visible, body.dark-mode select:focus-visible, body.dark-mode input:focus-visible, body.dark-mode [tabindex="0"]:focus-visible { outline-color: var(--secondary-color); }


  /* ---------- Header ---------- */
  header{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;background:var(--bg-card);color:var(--primary-color);box-shadow:var(--shadow);position:sticky;top:0;z-index:100;}
  header img{inline-size:48px;}
  header h1{font-weight:700;font-size:clamp(1.2rem,4vw+.4rem,1.8rem); flex-grow: 1; text-align: right;}
  body.dark-mode header{background:var(--card-dark);color:var(--primary-color)}

  /* ---------- Header Adjustments for Mobile ---------- */
  @media (max-width: 600px) {
    header { padding: .5rem 1rem; gap: .5rem; }
    header img { inline-size: 40px; }
    header h1 { font-size: clamp(1.0rem, 3.5vw + .4rem, 1.6rem); }
  }

  /* ---------- Navigation ---------- */
  nav{background:var(--secondary-color);box-shadow:var(--shadow)}
  .nav-wrap{display:flex;justify-content:space-around;align-items:center;max-inline-size:1200px;margin-inline:auto;block-size:56px}
  .nav-links{display:flex;flex:1;justify-content:space-around;list-style:none; align-items: center; }
  .nav-links a{display:flex;flex-direction:column;align-items:center;gap:.15rem; font-size:.72rem;font-weight:500;padding: .15rem .5rem .35rem .5rem; border-radius:6px;transition:background .2s,transform .2s, color .2s; color: var(--primary-color); text-decoration: none;}
  .nav-links i{font-size:1.15rem}
  .nav-links a.active,
  .nav-links a:focus-visible,
  .nav-links a:hover{background:var(--primary-color);color:var(--footer-text);}

  @media(max-width:600px){
    nav{position:fixed;inset-block-end:0;inset-inline:0; z-index: 99;}
    body{padding-block-end:56px}
  }
  @media(min-width:601px){
    nav { position: sticky; top: 0; z-index: 98; }
    .nav-wrap{block-size:64px}
    .nav-links a{font-size:.8rem}
  }
  body.dark-mode nav{background:#333}
  body.dark-mode .nav-links a{color:var(--text-dark)}
  body.dark-mode .nav-links a.active,
  body.dark-mode .nav-links a:focus-visible,
  body.dark-mode .nav-links a:hover{background:var(--primary-color);color:var(--footer-text)}


  /* ---------- Containers & sections ---------- */
   main { position: relative; z-index: 1; }
  .container{inline-size:clamp(90%,1200px,95%);margin-inline:auto;padding-block:1.25rem 2rem}
  section{background:var(--bg-card);padding:1.25rem 1rem;border-radius:12px;box-shadow:var(--shadow);margin-block-end:1.5rem}
  body.dark-mode section{background:var(--card-dark)}
  section h2{font-size:clamp(1.1rem,2.2vw+.7rem,1.6rem);margin-block-end:.75rem;color:var(--primary-color);border-block-end:2px solid var(--secondary-color);display:inline-block;padding-block-end:.25rem}
  body.dark-mode section h2{color:var(--primary-color);border-color:var(--secondary-color)}
   section h3 {
        font-size: clamp(1rem, 1.8vw + .6rem, 1.4rem);
        color: var(--primary-color);
        margin-top: 1.25rem;
        margin-bottom: 0.75rem;
   }
   body.dark-mode section h3 { color: var(--primary-color); }
   section p { margin-bottom: 1em; }
   section ul { list-style: disc; margin-left: 25px; margin-bottom: 1em; padding-left: 0; }
   section li { margin-bottom: 0.5em; }
   section strong { font-weight: 700; color: var(--primary-color); }
   body.dark-mode section strong { color: var(--primary-color); }


   /* Dashboard Card (for iframe sections) */
    .dashboard-card { background-color: var(--bg-card); border-radius: 10px; box-shadow: var(--shadow); padding: 20px; margin-bottom: 20px; transition: transform 0.3s, box-shadow 0.3s; }
    body.dark-mode .dashboard-card { background-color: var(--card-dark); }
    .dashboard-card:hover { transform: translateY(-5px); box-shadow: 0 6px 18px var(--shadow); }
    .dashboard-card h3 { margin-bottom: 15px; color: var(--primary-color); font-size: 1.4em; display: flex; align-items: center; gap: 10px; }
    body.dark-mode .dashboard-card h3 { color: var(--primary-color); }
    .dashboard-card iframe { width: 100%; border: none; border-radius: 5px; margin-bottom: 15px; background-color: #fff; /* Keep iframe background light */ }
    #foodIframe { height: 500px; }
    #lookerIframe { width: 100%; height: 550px; /* Use 100% width */ }


  /* ---------- Buttons & utilities ---------- */
  .button-link{display:inline-block;margin-block-start:1rem;padding:.6rem .9rem;background:var(--primary-color);color:var(--footer-text);border-radius:6px;font-weight:500;transition:background .25s,transform .25s; text-decoration: none;}
  .button-link i{margin-inline-start:.3rem}
  .button-link:hover{background:var(--secondary-color);color:var(--primary-color);transform:translateY(-2px)}
  body.dark-mode .button-link{color:var(--primary-color);} /* Adjust dark button text if needed */
  body.dark-mode .button-link:hover{background:var(--secondary-color);color:var(--primary-color);}

  .dashboard-card button { padding: 10px 15px; background-color: var(--primary-color); color: var(--footer-text); border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s, transform 0.3s; font-weight: 500; font-size: 0.9em; margin-top: 10px; display: inline-block; }
  body.dark-mode .dashboard-card button { color: var(--footer-text); }
  .dashboard-card button:hover { background-color: var(--secondary-color); color: var(--primary-color); transform: translateY(-2px); }
  body.dark-mode .dashboard-card button:hover { color: var(--primary-color); }


  /* ---------- Footer ---------- */
  footer{margin-block-start:3rem;padding:1rem;text-align:center;background:var(--footer-bg);color:var(--footer-text);font-size:.8rem}
  body.dark-mode footer{background:var(--footer-dark); color: var(--footer-text)}


  /* ---------- Dark-mode toggle button ---------- */
  .theme-toggle{background:none;border:none;font-size:1.6rem;cursor:pointer;color:var(--primary-color);padding:.25rem; margin-left: auto;}
  body.dark-mode .theme-toggle{color:var(--text-dark)}

  </style>
</head>

<body class="pink-theme"> <!-- Apply theme class -->

  <!----- header & theme toggle ----->
  <header>
    <img src="https://upload.wikimedia.org/wikipedia/en/thumb/8/82/MorrisonsLogo.svg/220px-MorrisonsLogo.svg.png" alt="Morrisons logo" />
    <h1>Cleveleys Morrisons Dashboard</h1>
    <button class="theme-toggle" aria-label="Toggle dark mode" aria-pressed="false">🌓</button>
  </header>

  <!----- nav (bottom bar on phones) ----->
  <nav>
    <div class="nav-wrap">
      <ul class="nav-links">
          <li><a href="index.html"><i class="fas fa-home"></i><span>Home</span></a></li>
          <li><a href="online.html"><i class="fas fa-globe"></i><span>Online</span></a></li>
          <li><a href="street.html" class="active"><i class="fas fa-store"></i><span>Market</span></a></li>
          <li><a href="services.html"><i class="fas fa-concierge-bell"></i><span>Front End</span></a></li>
          <li><a href="operations.html"><i class="fas fa-cogs"></i><span>Operations</span></a></li>
          <li><a href="contacts.html"><i class="fas fa-address-book"></i><span>Contacts</span></a></li>
          <li><a href="shrink.html"><i class="fas fa-compress-arrows-alt"></i><span>Shrink</span></a></li>
          <li><a href="safe-and-legal.html"><i class="fas fa-shield-alt"></i><span>Safe & Legal</span></a></li>
      </ul>
    </div>
  </nav>

  <!----- main content ----->
  <main class="container">
     <!-- Content Copied from original street.html -->
    <section id="market-street-overview">
      <h2>Market Street & Cafe Operations</h2>
      <p>Market Street is a unique strength, showcasing our foodmaker credentials. Cafe provides an extended customer experience. Delivering great service in these areas is key.</p>

      <h3>Market Street Service Principles:</h3>
      <ul>
        <li>Ensure tastings are offered.</li>
        <li>Colleagues always available to serve on Counters.</li>
        <li>Acknowledge customers, say hello, and smile every time. Thank and say goodbye.</li>
        <li>Build rapport to encourage questions.</li>
        <li>Offer tastings for new or interesting products.</li>
        <li>Use expert knowledge to provide advice.</li>
        <li>Suggest suitable alternatives if a line is unavailable.</li>
        <li>Follow correct markdown and waste procedures (see <a href="#markdown-waste">Markdown/Waste Timings</a> below).</li>
        <li>Adhere to range guidelines for counters (e.g., Butchery 17 core lines, Fish 8 core overwrap lines).</li>
         <li>Maintain clean counters, glass, and tidy work areas. Ensure correct POS and marketing.</li>
      </ul>
       <a href="https://example.com/market-street-success-video" target="_blank" rel="noopener noreferrer" class="button-link">Market Street Success Video (Example Link) <i class="fas fa-external-link-alt fa-xs"></i></a>

      <h3>Cafe Service Principles:</h3>
       <ul>
           <li>Focus on food quality, availability, timely service at the right temperature.</li>
           <li>Ensure friendly, helpful colleagues greet, serve, and thank customers.</li>
           <li>Maintain a warm, clean, and welcoming environment.</li>
           <li>Be present during busy periods (breakfast, lunch, teatime) to understand customer experience.</li>
           <li>Complete the Cafe Top 10 Checklist daily.</li>
           <li>Manage queues effectively.</li>
           <li>Provide child-friendly facilities (activity space, clean baby changing).</li>
      </ul>
       <a href="https://example.com/cafe-daily-checklist" target="_blank" rel="noopener noreferrer" class="button-link">Cafe Daily Checklist (Example Link) <i class="fas fa-external-link-alt fa-xs"></i></a>
       <a href="https://example.com/cafe-poster" target="_blank" rel="noopener noreferrer" class="button-link">Cafe Poster (Example Link) <i class="fas fa-external-link-alt fa-xs"></i></a>

    </section>

    <section id="fresh-food-ops">
        <h2>Fresh Food Operations Summary</h2>
        <p>Maintaining fresh food quality and availability requires adherence to specific routines.</p>
        <ul>
            <li><strong>Replenishment & Rotation:</strong> Follow 'first in, first out'. Check dates as you merchandise. Ensure correct layout and SELs. No gap filling. Keep areas clean.</li>
            <li><strong>Stock Management:</strong> Perform daily Gaps & Counts (06:00-12:00), including pre-packed Market Street. Follow specific day rules (Monday Reset - all gaps; Tue-Sun - new/green gaps). PM Gap Scan for direct delivered milk.</li>
            <li><strong>Waste Parade & Validation (09:00):</strong> Daily, Store Manager led. Discuss root causes, challenge missed markdowns/poor quality. Complete Waste Validation check on mobile device. Process waste correctly (Too Good To Go, Colleague Collection, Charity, Backhaul).</li>
            <li><strong>Chiller Organisation:</strong> Maintain clean, organised chillers with designated areas (Waste, Markdowns, Critical). Stock rotated, floor clean.</li>
            <li><strong>Code Checking:</strong> Follow the Fresh Food Code Check App guidance. Markdowns processed via Simple Markdowns App (7pm-11pm day before expiry; 5pm day of expiry clearance).</li>
             <li><strong>Markdown & Waste Timings:</strong> Strict timings apply per department (e.g., Bakery Baguettes/Sticks - waste end of day; Doughnuts - waste end of 24hr life; Deli Meats - 50% markdown end of counter life; Oven Fresh/Pies - 50% markdown 1hr before close; Salad Bar - pot up 6pm). See guide for full details.</li>
        </ul>
         <p>Refer to the 'Fresh Food Operating Guidance' document for detailed operating clocks and procedures.</p>
         <a href="https://example.com/fresh-food-op-guide" target="_blank" rel="noopener noreferrer" class="button-link">View Full Fresh Food Guide (Example Link) <i class="fas fa-external-link-alt fa-xs"></i></a>
    </section>

    <section id="markdown-waste">
        <h2>Market Street Markdown Timings</h2>
        <p>Specific markdown times apply to Market Street products:</p>
        <ul>
            <li><strong>General Markdown Window:</strong> <strong>Monday - Saturday 5pm</strong>, <strong>Sunday 3pm</strong> (4pm Scotland). This applies unless specific exceptions below.</li>
            <li><strong>Exceptions:</strong>
                <ul>
                    <li><strong>Baguettes/Sticks:</strong> No markdown, waste end of day.</li>
                    <li><strong>Doughnuts:</strong> Waste end of 24hr shelf life (can go in TGTG bags).</li>
                    <li><strong>Pick & Mix/Crusty Rolls:</strong> Bag up remaining at 7:30pm (4pk 'Reduced to Clear' PLU 1263). Sell next day, no further markdown. Waste remaining rolls 7:30pm day of production.</li>
                    <li><strong>Deli Sliced Cooked Meats:</strong> 50% markdown end of counter life, move to clearance.</li>
                    <li><strong>Oven Fresh & Pie Shop:</strong> 50% markdown 1 hour before counter close.</li>
                    <li><strong>Salad Bar:</strong> Pot up remaining into small trays, label with GLP at 6pm.</li>
                    <li><strong>Cafe Sandwiches:</strong> 50% markdown at 5pm.</li>
                </ul>
            </li>
        </ul>
         <p>Always follow the selected second process for loose produce markdowns <a href="https://example.com/loose-produce-markdown" target="_blank" rel="noreferrer noopener">here (Example Link)</a>.</p>
         <p>Berries receive only one markdown at 5pm on day of expiry.</p>
         <p>Plants: Check condition daily, apply markdown as appropriate based on shelf life (Flowering: 2 weeks; Foliage: 4 weeks from closed code).</p>
         <p>Sandwiches (Pre-Packed): 50% markdown at 5pm on day of expiry.</p>
    </section>


    <!-- Dashboard Card: Food to Order -->
    <div class="dashboard-card">
      <h3><i class="fas fa-utensils"></i> Food to Order (Collection Info)</h3>
      <iframe id="foodIframe" title="Food to Order Spreadsheet" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSGwiw2DKxtkQKOCvQkFbaB2uM05dfTw_8FyfflTX5q_Cvc7UtN5ZSQ2lSIDKYKA_-V2BTebS6i-4_t/pubhtml?gid=1577160612&single=true&widget=true&headers=false"></iframe>
      <button type="button" onclick="printIframe('foodIframe')">Print Food Order</button>
      <p style="margin-top: 1em;">Note: Food to Order is now processed via online Click & Collect. This sheet may show collection details. Assist customers at the CSD as needed.</p>
       <a href="https://groceries.morrisons.com/webshop/foodToOrderHomepage.do" target="_blank" rel="noopener noreferrer" class="button-link">Food To Order Website <i class="fas fa-external-link-alt fa-xs"></i></a>
    </div>

    <!-- Dashboard Card: Looker Studio Report -->
    <div class="dashboard-card">
      <h3><i class="fas fa-chart-line"></i> Looker Studio Report (Example)</h3>
      <iframe id="lookerIframe" title="Looker Studio Report"
              src="https://lookerstudio.google.com/embed/reporting/65cb4d97-37d3-4de9-aab2-096b5d753b96/page/p_3uhgsgcvld"
              frameborder="0" allowfullscreen
              sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
      <button type="button" onclick="printIframe('lookerIframe')">Print Report</button>
    </div>
    <!-- End Content -->
  </main>

  <!----- footer ----->
  <footer><p>© 2025 Cleveleys Morrisons. All rights reserved.</p></footer>

  <!----- scripts ----->
  <script>
    (()=>{ // Start IIFE
      'use strict';

      /* dark-mode toggle */
      const themeBtn=document.querySelector('.theme-toggle');
      const setMode=isDark=>{
          document.body.classList.toggle('dark-mode',isDark);
          themeBtn.setAttribute('aria-pressed',isDark);
          localStorage.setItem('theme',isDark?'dark':'light');
          // Update meta theme-color for dynamic changes on this page
          document.querySelector('meta[name="theme-color"]').setAttribute('content', isDark ? '#8B008B' : '#D13887');
      };
      themeBtn.addEventListener('click',()=>setMode(!document.body.classList.contains('dark-mode')));

      /* Initial theme and dark mode load */
      document.addEventListener('DOMContentLoaded', () => {
           const savedTheme = localStorage.getItem('theme');
           setMode(saved?saved==='dark':matchMedia('(prefers-color-scheme:dark)').matches);

           // Apply Pink Theme Class
           document.body.classList.add('pink-theme');
           void document.body.offsetHeight;
       });
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => { if (!localStorage.getItem('theme')) { setMode(event.matches); } });

      // Expose print function globally ONLY if using inline onclick
      window.printIframe = function(iframeId) {
            const iframe = document.getElementById(iframeId);
            if (!iframe) {
                console.error("Iframe not found:", iframeId);
                return;
            }
            try {
                const iframeWindow = iframe.contentWindow || iframe;
                iframeWindow.focus();
                iframeWindow.print();
            } catch (e) {
                console.error("Printing failed, possibly due to cross-origin restrictions or iframe content:", e);
                const iframeSrc = iframe.src;
                 if (iframeSrc && iframeSrc !== 'about:blank') {
                    const printWindow = window.open(iframeSrc, '_blank');
                     if(printWindow) {
                        printWindow.onload = function () {
                           setTimeout(() => { printWindow.print(); }, 500);
                       };
                    } else {
                        alert("Could not open print window. Please check popup blocker settings.");
                    }
                } else {
                    alert("Cannot print this content directly.");
                }
            }
        }

      /* --- PWA Service Worker Registration --- */
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('Service Worker registered successfully with scope: ', registration.scope);
            })
            .catch(err => {
              console.error('Service Worker registration failed: ', err);
            });
        });
      }

    })(); // End IIFE
  </script>
</body>
</html>
